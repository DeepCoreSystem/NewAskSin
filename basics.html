<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>NewAskSin: Basic Concepts</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NewAskSin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Basic Concepts </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="protocol_basics"></a>
Protocol Basics</h1>
<p>Messages are exchanged between devices (including central units) by way of message frames sent out by a device (source). These messages can be received by any other device. Depending on the destination address and configuration of the receiving device, it will decide how to handle the message:</p>
<ul>
<li>A receiving device configured as peer will be adressed as destination of the message and acknowledge the reception of the message by means of an ACK frame. This way the source device will know if the message was received and can try retransmission upon timeout.</li>
<li>Messages addressed to the special broadcast address will not be acknowledged and can be used for measurement data or alike that are of volatile nature.</li>
</ul>
<h2><a class="anchor" id="device_address"></a>
Device Address</h2>
<p>Every device is addressed by a unique 3-byte ID (aka 'HM-ID'). This address is usually expressed in hexadezimal form, ommiting any hex denominating prefix commonly used in programming languages (prefix '0x'). Valid device IDs range from <code>000001</code> to <code>FFFFFE</code>. ID <code>000000</code> is reserved as broadcast address when sending out data frames that do not require acknowledgement.</p>
<h2><a class="anchor" id="message_frame"></a>
Message Frames</h2>
<p>All message frames follow the same structure with a fixed-length message header and a variable-length payload: </p>
<pre>
             |                               Message Header                                  |              Payload
-------------+-------------------------------------------------------------------------------+----------------------------------
Index        |   0   |   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   |   10  |        ...       | Len-1
-------------+-------+-------+-------+-------+-----------------------+-----------------------+----------------------------------
Description  |  Len  | Count | Flags | Type  |     Source-Address    |  Destination-Address  |    (depending on message type)
</pre><dl>
<dt>Len </dt>
<dd><p class="startdd">Length of the complete message frame, including header and payload. Maximum allowed length is 26.</p>
<p class="enddd"></p>
</dd>
<dt>Count </dt>
<dd><p class="startdd">Message frame counter, incremented by the source device each time a message is sent.</p>
<p class="enddd"></p>
</dd>
<dt>Flags </dt>
<dd><p class="startdd">Message status flags, for more information see <a class="el" href="basics.html#message_flags">Message Flags</a></p>
<p class="enddd"></p>
</dd>
<dt>Type </dt>
<dd><p class="startdd">Defines how the payload is to be interpreted. For more details, see message_type</p>
<p class="enddd"></p>
</dd>
<dt>Source-Address </dt>
<dd><p class="startdd">3-Byte address of the source device. Often referred to as <a class="el" href="EEprom_8h.html#a58db4a599efa5be22a0ff4543951d6ff">HMID</a>.</p>
<p class="enddd"></p>
</dd>
<dt>Destination-Address </dt>
<dd><p class="startdd">3-Byte address of the destination. Broadcasts are addressed to 000000. Also see <a class="el" href="EEprom_8h.html#a58db4a599efa5be22a0ff4543951d6ff">HMID</a>.</p>
<p class="enddd"></p>
</dd>
<dt>Payload </dt>
<dd><p class="startdd">Carries the information transported by the message frame. Payload content is to be interpreted according to the message_type</p>
<p class="enddd"></p>
</dd>
</dl>
<h2><a class="anchor" id="message_flags"></a>
Message Flags</h2>
<p>The message flags byte carries status information relevant for protocol handling. It comprises the following bits:</p>
<ul>
<li>0x80: Message to master or message could be repeated</li>
<li>0x40: Repeated message</li>
<li>0x20: ACK requested</li>
<li>0x10: Burst transmission</li>
<li>0x08: unknown</li>
<li>0x04: Config mode (broadcast)</li>
<li>0x02: Wake me up</li>
<li>0x01: Wakeup</li>
</ul>
<h2><a class="anchor" id="message_types"></a>
Message Types</h2>
<p>The message type defines how the payload oof the message is to be interpreted. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd><p class="startdd">Write much more about message types. </p>
<p class="enddd">Decide if every message type should have its own subsubsection</p>
</dd></dl>
<h1><a class="anchor" id="device_model_basics"></a>
Device Model</h1>
<h2><a class="anchor" id="basics_device_channels"></a>
Device Channels</h2>
<p>Device properties are organized in form of channels, with special channel 0 that represents the device entity that communicates with others and at least one more channel that represents a sensor, actuator, or alike.</p>
<h2><a class="anchor" id="basics_device_registers"></a>
Device Registers</h2>
<p>Seen from the protocol prespective, the configuration of a device is represented in form of registers each of which has an ID for identification and a one-byte-content that affects the behavior of the device. Registers are solely used for configuration purposes. Static information that is hardcoded into the device software, like serial number or <a class="el" href="EEprom_8h.html#a58db4a599efa5be22a0ff4543951d6ff">HMID</a>, is not represented by registers but can be queried using special messages.</p>
<p>Often, register specifications are written as a list of ID:VALUE pairs:</p>
<p>List0: 02:01 05:00 0A:AB 0B:CD 0C:EF 14:05 24:05 25:DC 26:05 27:03 00:00</p>
<p>This example shows that the device is paired to ID 'ABCDEF', represented by registers 0A, 0B and 0C.</p>
<p>A device organizes registers in the context of lists that are used for specific purposes: </p>
<dl>
<dt>List0 </dt>
<dd><p class="startdd">Represents the device configuration. Each device has exactly one instance of this list and it is associated with channel 0.</p>
<p class="enddd"></p>
</dd>
<dt>List1 </dt>
<dd><p class="startdd">Represents per-channel configuration. Each channel of a device must have a List1 and one of List3 or List4.</p>
<p class="enddd"></p>
</dd>
<dt>List2 </dt>
<dd><p class="startdd"></p>
<p class="enddd"></p>
</dd>
<dt>List3 </dt>
<dd><p class="startdd"></p>
<p class="enddd"></p>
</dd>
<dt>List4 </dt>
<dd><p class="startdd"></p>
<p class="enddd"></p>
</dd>
<dt>List5..List9 </dt>
<dd><p class="startdd"></p>
<p class="enddd"></p>
</dd>
</dl>
<p>In the NewAskSin framework, registers are defined </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jul 7 2015 21:39:16 for NewAskSin by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
